%% General packages
\usepackage[utf8]{inputenc} % For coding and special characters
\usepackage[T1]{fontenc}
\usepackage{lmodern} % Fancier font
\usepackage[top=3cm,bottom=3cm,left=2.5cm,right=2.5cm]{geometry} 

\usepackage{graphicx} 
\usepackage{blindtext} 

%% Colors
\usepackage{xcolor} % Farben
\definecolor{aaudarkblue}{RGB}{67, 111, 128}
\definecolor{aaublue}{RGB}{83, 159, 198}
\definecolor{aaulightgray}{RGB}{232,232,232}
\definecolor{aaugray}{RGB}{98,98,98}

%% Design Choices
\usepackage[labelfont=bf]{caption}
\usepackage{enumitem}
\usepackage{float}
\setlist[itemize]{label=$\blacktriangleright$}

%% Header and footer
\usepackage[autooneside=false, automark]{scrlayer-scrpage} 
\pagestyle{scrheadings} % Activate style
\clearpairofpagestyles % Clear current setting
\automark[section]{section} % set \headmark to contain the headings of \section
\ihead{\textnormal{\headmark}} % reference to the adjusted headmark at the inside of the head
\ohead[\pagemark]{\pagemark} % reference to the page number at the outside of the head
\KOMAoptions{headsepline = true} % Activate seperation line for the header

%% (Framed) theorem environments
\usepackage[framemethod=TikZ]{mdframed}
\mdfdefinestyle{theoremstyle}{ % Define new style for theorems
	linecolor=aaublue,
	linewidth=1pt,
	frametitlerule=false,%
	apptotikzsetting={\tikzset{mdfframetitlebackground/.append style={
	color=aaublue!65}}},
	innertopmargin=\topskip,
	innerbottommargin=\topskip,
	nobreak=false,
	backgroundcolor=aaublue!15,
	frametitlefont=\bfseries,
	theoremtitlefont=\normalfont,
	theoremseparator = {},
	footnoteinside=false
}

% Theorem
\mdtheorem[style=theoremstyle]{theoremx}[examplex]{Theorem} 
\newenvironment{theorem}[1][]{% Add brackets around caption for the numbered environment
    \begin{theoremx}[\ifx&#1&\else(#1)\fi]%
}{%
    \end{theoremx}%
}
\newenvironment{theorem*}[1][]{% add brackets around caption for the unnumbered environment
    \begin{theoremx*}[\ifx&#1&\else(#1)\fi]%
}{%
    \end{theoremx*}%
}

% Propositon
\mdtheorem[style=theoremstyle]{propositionx}[examplex]{Proposition} 
\newenvironment{proposition}[1][]{% Add brackets around caption for the numbered environment
    \begin{propositionx}[\ifx&#1&\else(#1)\fi]%
}{%
    \end{propositionx}%
}
\newenvironment{proposition*}[1][]{% add brackets around caption for the unnumbered environment
    \begin{propositionx*}[\ifx&#1&\else(#1)\fi]%
}{%
    \end{propositionx*}%
}

% Lemma
\mdtheorem[style=theoremstyle]{lemmax}[examplex]{Lemma} 
\newenvironment{lemma}[1][]{% Add brackets around caption for the numbered environment
    \begin{lemmax}[\ifx&#1&\else(#1)\fi]%
}{%
    \end{lemmax}%
}
\newenvironment{lemma*}[1][]{% add brackets around caption for the unnumbered environment
    \begin{lemmax*}[\ifx&#1&\else(#1)\fi]%
}{%
    \end{lemmax*}%
}

% Proposition
\mdtheorem[style=theoremstyle]{corollaryx}[examplex]{Corollary} 
\newenvironment{corollary}[1][]{% Add brackets around caption for the numbered environment
    \begin{corollaryx}[\ifx&#1&\else(#1)\fi]%
}{%
    \end{corollaryx}%
}
\newenvironment{corollary*}[1][]{% add brackets around caption for the unnumbered environment
    \begin{corollaryx*}[\ifx&#1&\else(#1)\fi]%
}{%
    \end{corollaryx*}%
}

\mdfdefinestyle{definitionstyle}{ % Define new style for definitions
	linecolor=aaulightgray!135,
	linewidth=1pt,
	frametitlerule=false,%
	apptotikzsetting={\tikzset{mdfframetitlebackground/.append style={
	color=aaulightgray}}},
	innertopmargin=\topskip,
	innerbottommargin=\topskip,
	nobreak=false,
	backgroundcolor=aaulightgray!50,
	frametitlefont=\bfseries,
	theoremtitlefont=\normalfont,
	theoremseparator = {},
	footnoteinside=false
}

% Definition
\mdtheorem[style=definitionstyle]{definitionx}[examplex]{Definition}
\newenvironment{definition}[1][]{% Add brackets around caption for the numbered environment
    \begin{definitionx}[\ifx&#1&\else(#1)\fi]%
}{%
    \end{definitionx}%
}
\newenvironment{definition*}[1][]{% add brackets around caption for the unnumbered environment
    \begin{definitionx*}[\ifx&#1&\else(#1)\fi]%
}{%
    \end{definitionx*}%
}

% Example
\newtheoremstyle{examplestyle} % Define new style for examples (bold heading, linebreak, normal text)
	{\topsep}{\topsep}
	{}{}
	{\bfseries}{}
	{\newline}{}
\theoremstyle{examplestyle} % Activate style
\newtheorem{examplex}{Example} % New environment for numbered examples
\newtheorem*{examplexx}{Example} % New environment for unnumbered examples
\newenvironment{example} % Add triangle at the end of the numbered example environment
	{\pushQED{\qed}\renewcommand{\qedsymbol}{$\triangle$}\examplex}
	{\popQED\endexamplex}
\newenvironment{example*} % Add triangle at the end of the unnumbered example environment
	{\pushQED{\qed}\renewcommand{\qedsymbol}{$\triangle$}\examplexx}
	{\popQED\endexamplexx}
  
% Remark/Notation
\newtheoremstyle{remarkstyle} % Define new style for remarks (bold heading, nomral text)
	{\topsep}{\topsep}
	{}{}
	{\bfseries}{.}
	{5pt plus 1pt minus 1pt}{}
\theoremstyle{remarkstyle} % Activate style
\newtheorem{remarkx}[examplex]{Remark} % New environment for numbered remarks
\newtheorem*{remarkxx}{Remark} % New environment for unnumbered remarks
\newenvironment{remark} % Add diamond at the end of an numbered remark environment
	{\pushQED{\qed}\renewcommand{\qedsymbol}{$\diamond$}\remarkx}
	{\popQED\endremarkx}
\newenvironment{remark*} % Add diamond at the end of an unnumbered remark environment
	{\pushQED{\qed}\renewcommand{\qedsymbol}{$\diamond$}\remarkxx}
	{\popQED\endremarkxx}

\newtheorem{notation}[examplex]{Notation} % New environments for numbered notation
\newtheorem*{notation*}{Notation} % New environments for unnumbered notation

%% References
\usepackage[
	backend=biber, 
	bibstyle=numeric,
	natbib=true, 
	hyperref=true,
]{biblatex} 
\let\oldprintbibliography\printbibliography
\renewcommand{\printbibliography}{% adds new page and correct reference for the table of contents
	\newpage \phantomsection
	\addcontentsline{toc}{section}{References}
	\oldprintbibliography
}
\usepackage{csquotes}

\usepackage{hyperref} 